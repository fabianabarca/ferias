{% extends 'base.html' %}

{% load static %}

{% block main %}

<h1>Página interactiva</h1>

<p>En un lugar de La Mancha, de cuyo nombre no quiero acordarme, no ha mucho tiempo que vivía un caballeros de los adarga antigua, rocín flaco, lanza en astillero y galgo corredor.</p>

<div>
    <canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const ctx = document.getElementById('myChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
      datasets: [{
        label: '# of Votes',
        data: [12, 19, 3, 5, 2, 3],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js" integrity="sha512-0z8URjGET6GWnS1xcgiLBZBzoaS8BNlKayfZyQNKz4IRp+s7CKXx0yz7Eco2+TcwoeMBa5KMwmTX7Kus7Fa5Uw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  
<script>
    //parms: x,y,width,height,options
    let engine = Matter.Engine.create();

    let render = Matter.Render.create({
        element: document.body,
        engine:engine
    });

    let ground = Matter.Bodies.rectangle(400,600,810,60,{ isStatic: true}); 
    let boxA = Matter.Bodies.rectangle(400,200,80,80);
    let boxB = Matter.Bodies.rectangle(450,50,80,80);

    let mouse = Matter.Mouse.create(render.canvas);
    let mouseConstraint = Matter.MouseConstraint.create(engine, {
        mouse: mouse,
        constraint: {
            render: {visible: false}
        }
    });
    render.mouse = mouse;

    Matter.World.add(engine.world, [boxA, boxB, ground, mouseConstraint]);

    let platform = Matter.Bodies.rectangle(1200, 500, 300, 20, { isStatic: true });
    let stack = Matter.Composites.stack(1100, 270, 4, 4, 0, 0, function(x, y) {
        return Matter.Bodies.polygon(x, y, 8, 30); 
    });

    let ball = Matter.Bodies.circle(300, 600,20);
    let sling = Matter.Constraint.create({ 
        pointA: { x: 300, y: 600 }, 
        bodyB: ball, 
        stiffness: 0.05
    });

    let firing = false;
    Matter.Events.on(mouseConstraint,'enddrag', function(e) {
        if(e.body === ball) firing = true;
    });

    Matter.Events.on(engine,'afterUpdate', function() {
        if (firing && Math.abs(ball.position.x-300) < 20 && Math.abs(ball.position.y-600) < 20) {
            ball = Matter.Bodies.circle(300, 600, 20);
            Matter.World.add(engine.world, ball);
            sling.bodyB = ball;
            firing = false;
        }
    });

    Matter.World.add(engine.world, [platform, stack, ball, sling, firing]);
    Matter.Engine.run(engine);
    Matter.Render.run(render);
</script>
{% endblock %}


